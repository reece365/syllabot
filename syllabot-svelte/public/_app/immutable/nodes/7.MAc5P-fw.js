import"../chunks/DsnmJJEf.js";import"../chunks/m-0LQmtk.js";import{o as va}from"../chunks/2CaVVPCb.js";import{aw as fa,az as da,ao as ma,J as _a,aA as pa,aB as ha,p as ga,f,b as B,a as n,d as ba,c as b,s as q,e as u,m as y,t as F,g as e,aC as ya,r as p,n as xa,au as wa,h as E}from"../chunks/AgECxNoQ.js";import{s as A,e as Sa}from"../chunks/BmW0P4qu.js";import{i as N}from"../chunks/OeCMHk3k.js";import{e as G,i as H}from"../chunks/B8m8Q4zd.js";import{i as Ca}from"../chunks/CPumr6NK.js";import{T as $a,P as K}from"../chunks/h__pBkD3.js";import{B as qa}from"../chunks/De81ln4i.js";import{g as Q,c as V,d as W,f as Oa,q as Pa,a as ka}from"../chunks/HFaa_CaF.js";function X(a,r,d=!1){if(a.multiple){if(r==null)return;if(!_a(r))return pa();for(var t of a.options)t.selected=r.includes(L(t));return}for(t of a.options){var o=L(t);if(ha(o,r)){t.selected=!0;return}}(!d||r!==void 0)&&(a.selectedIndex=-1)}function Ba(a){var r=new MutationObserver(()=>{X(a,a.__value)});r.observe(a,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),ma(()=>{r.disconnect()})}function Fa(a,r,d=r){var t=!0;fa(a,"change",o=>{var m=o?"[selected]":":checked",_;if(a.multiple)_=[].map.call(a.querySelectorAll(m),L);else{var x=a.querySelector(m)??a.querySelector("option:not([disabled])");_=x&&L(x)}d(_)}),da(()=>{var o=r();if(X(a,o,t),t&&o===void 0){var m=a.querySelector(":checked");m!==null&&(o=L(m),d(o))}a.__value=o,t=!1}),Ba(a)}function L(a){return"__value"in a?a.__value:a.value}var La=f("<option> </option>"),Ma=f('<h3 class="text-lg font-semibold mb-2">Select School</h3> <p class="text-gray-500 mb-4">Choose your institution to manage its classes.</p> <select class="w-full border rounded px-3 py-2"><option disabled selected> </option><!></select>',1),Aa=f("<p>Loading classes…</p>"),Na=f('<p class="text-red-500"> </p>'),Ta=f("<p>No classes found.</p>"),Ua=f("<li> </li>"),ja=f('<ul class="space-y-2"></ul>'),za=f('<div class="flex justify-between items-center mb-2"><h3 class="text-lg font-semibold">Classes</h3> <!></div> <!>',1),Da=f('<!> <main class="max-w-xl mx-auto mt-8"><!> <!></main>',1);function Ya(a,r){ga(r,!1);let d=y([]),t=y(""),o=y([]),m=y(!1),_=y(!0),x=y(!1),M=y("");va(async()=>{try{u(_,!0);const l=await Q(V(W,"schools"));u(d,l.docs.map(c=>{const h=c.data();return{id:c.id,name:h.name||"Unnamed School"}}))}catch{u(M,"Failed to load schools.")}finally{u(_,!1)}});async function Y(l){const c=l.target;c&&(u(t,c.value),u(m,!0),await Z())}async function Z(){if(e(t)){u(x,!0);try{const l=V(W,"schools",e(t),"classes"),c=Pa(l),h=await Q(c);u(o,h.docs.map(v=>{const i=v.data();return{id:v.id,name:i.name||"Unnamed Class"}}))}catch{u(M,"Failed to load classes.")}finally{u(x,!1)}}}async function aa(){}async function ea(){await Oa(ka),window.location.href="/auth"}Ca();var D=Da(),I=B(D);$a(I,{title:"Syllabot Management",showSignOut:!0,onSignOut:ea});var J=q(I,2),R=b(J);K(R,{children:(l,c)=>{var h=Ma(),v=q(B(h),4);F(()=>{e(t),ya(()=>{e(_),e(d)})});var i=b(v),T=b(i,!0);p(i),i.value=i.__value="";var U=q(i);G(U,1,()=>e(d),H,(O,P)=>{var s=La(),g=b(s,!0);p(s);var w={};F(()=>{A(g,e(P).name),w!==(w=e(P).id)&&(s.value=(s.__value=e(P).id)??"")}),n(O,s)}),p(v),F(()=>A(T,e(_)?"Loading schools…":"Select a school…")),Sa("change",v,Y),Fa(v,()=>e(t),O=>u(t,O)),n(l,h)},$$slots:{default:!0}});var ta=q(R,2);{var sa=l=>{K(l,{children:(c,h)=>{var v=za(),i=B(v),T=q(b(i),2);qa(T,{$$events:{click:aa},children:(s,g)=>{xa();var w=wa("New Class");n(s,w)},$$slots:{default:!0}}),p(i);var U=q(i,2);{var O=s=>{var g=Aa();n(s,g)},P=s=>{var g=E(),w=B(g);{var ra=S=>{var C=Na(),j=b(C,!0);p(C),F(()=>A(j,e(M))),n(S,C)},oa=S=>{var C=E(),j=B(C);{var la=$=>{var k=Ta();n($,k)},na=$=>{var k=ja();G(k,5,()=>e(o),H,(ia,ua)=>{var z=Ua(),ca=b(z,!0);p(z),F(()=>A(ca,e(ua).name)),n(ia,z)}),p(k),n($,k)};N(j,$=>{e(o).length===0?$(la):$(na,!1)},!0)}n(S,C)};N(w,S=>{e(M)?S(ra):S(oa,!1)},!0)}n(s,g)};N(U,s=>{e(x)?s(O):s(P,!1)})}n(c,v)},$$slots:{default:!0}})};N(ta,l=>{e(m)&&l(sa)})}p(J),n(a,D),ba()}export{Ya as component};
